<!DOCTYPE html>
<html>
  <head>
    <title>48 Card Tarot Game</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script>
      // Define the 48 tarot cards with unique textures, sounds, and editable names
      const tarotDeck = [
        { name: 'The Fool', texture: 'https://example.com/card1.jpg', sound: 'https://example.com/sound1.mp3' },
        { name: 'The Magician', texture: 'https://example.com/card2.jpg', sound: 'https://example.com/sound2.mp3' },
        { name: 'The High Priestess', texture: 'https://example.com/card3.jpg', sound: 'https://example.com/sound3.mp3' },
        { name: 'The Empress', texture: 'https://example.com/card4.jpg', sound: 'https://example.com/sound4.mp3' },
        { name: 'The Emperor', texture: 'https://example.com/card5.jpg', sound: 'https://example.com/sound5.mp3' },
        { name: 'The Hierophant', texture: 'https://example.com/card6.jpg', sound: 'https://example.com/sound6.mp3' },
        { name: 'The Lovers', texture: 'https://example.com/card7.jpg', sound: 'https://example.com/sound7.mp3' },
        { name: 'The Chariot', texture: 'https://example.com/card8.jpg', sound: 'https://example.com/sound8.mp3' },
        { name: 'Strength', texture: 'https://example.com/card9.jpg', sound: 'https://example.com/sound9.mp3' },
        { name: 'The Hermit', texture: 'https://example.com/card10.jpg', sound: 'https://example.com/sound10.mp3' },
        // Add all 48 cards similarly...
        { name: 'The World', texture: 'https://example.com/card48.jpg', sound: 'https://example.com/sound48.mp3' }
      ];

      // Function to shuffle the deck and pick 9 cards
      function shuffleAndPick(deck, num) {
        for (let i = deck.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [deck[i], deck[j]] = [deck[j], deck[i]];
        }
        return deck.slice(0, num);
      }

      // Pick 9 random cards
      const pickedCards = shuffleAndPick(tarotDeck, 9);

      // Card back texture
      const cardBackTexture = 'https://example.com/card-back.jpg';  // Placeholder for card back image

      // Function to create card elements in A-Frame
      function createCardElements(cards) {
        const sceneEl = document.querySelector('a-scene');

        cards.forEach((card, index) => {
          const cardEl = document.createElement('a-entity');
          const row = Math.floor(index / 3);
          const col = index % 3;

          // Create the card back
          const backEl = document.createElement('a-plane');
          backEl.setAttribute('class', 'card-back');
          backEl.setAttribute('position', `${col * 1.5 - 1.5} ${1.5 - row * 2.25} -4`);
          backEl.setAttribute('width', '1');
          backEl.setAttribute('height', '2');
          backEl.setAttribute('src', cardBackTexture);
          backEl.setAttribute('material', 'side: double; shader: flat');
          backEl.setAttribute('data-index', index);
          backEl.setAttribute('opacity', '0');
          backEl.setAttribute('animation__fadein', {
            property: 'opacity',
            to: '1',
            dur: 1000,
            delay: index * 500
          });

          // Create the card front
          const frontEl = document.createElement('a-plane');
          frontEl.setAttribute('class', 'card-front');
          frontEl.setAttribute('position', `${col * 1.5 - 1.5} ${1.5 - row * 2.25} -4`);
          frontEl.setAttribute('width', '1');
          frontEl.setAttribute('height', '2');
          frontEl.setAttribute('src', card.texture);
          frontEl.setAttribute('material', 'side: double; shader: flat; visible: false');
          frontEl.setAttribute('data-index', index);

          // Create the card name text
          const textEl = document.createElement('a-text');
          textEl.setAttribute('value', card.name);
          textEl.setAttribute('color', 'red');
          textEl.setAttribute('position', `${col * 1.5 - 1.5} ${1.5 - row * 2.25 - 1.25} -4`);
          textEl.setAttribute('align', 'center');
          textEl.setAttribute('width', '2');
          textEl.setAttribute('visible', 'false');
          textEl.setAttribute('data-index', index);

          // Create the sound entity
          const soundEl = document.createElement('a-sound');
          soundEl.setAttribute('src', card.sound);
          soundEl.setAttribute('data-index', index);
          cardEl.appendChild(soundEl);

          // Append elements to the scene
          cardEl.appendChild(backEl);
          cardEl.appendChild(frontEl);
          cardEl.appendChild(textEl);
          sceneEl.appendChild(cardEl);

          // Add event listener for click to flip the card and scale up
          backEl.addEventListener('click', () => flipCard(index));
          frontEl.addEventListener('click', () => scaleCard(index));
        });
      }

      // Function to flip the card
      function flipCard(index) {
        const backs = document.querySelectorAll('.card-back');
        const fronts = document.querySelectorAll('.card-front');
        const texts = document.querySelectorAll('a-text');
        const sounds = document.querySelectorAll('a-sound');

        backs[index].setAttribute('visible', false);
        fronts[index].setAttribute('visible', true);
        texts[index].setAttribute('visible', true);

        // Stop all sounds
        sounds.forEach(sound => {
          sound.components.sound.stopSound();
        });

        // Play the sound for the clicked card
        sounds[index].components.sound.playSound();
      }

      // Function to scale the card to full screen
      function scaleCard(index) {
        const cardEl = document.querySelectorAll('a-entity')[index];
        cardEl.setAttribute('animation__scaleup', {
          property: 'scale',
          to: '3 3 3',
          dur: 500
        });
        cardEl.setAttribute('animation__moveup', {
          property: 'position',
          to: '0 1.6 -4',
          dur: 500
        });
      }

      // Wait for A-Frame to load, then create card elements
      window.onload = () => {
        createCardElements(pickedCards);
      };
    </script>

    <a-scene>
      <a-camera position="0 -0.7 2">
        <a-cursor></a-cursor>
      </a-camera>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene>
  </body>
</html>
